{"dependencies":[{"name":"@babel/runtime/helpers/classCallCheck","data":{"asyncType":null,"locs":[{"start":{"line":52,"column":61,"index":1773},"end":{"line":55,"column":3,"index":1869}}],"key":"ohGilxjVqjyE1GooDVDt9OYg9x0="}},{"name":"@babel/runtime/helpers/createClass","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":183,"column":0,"index":5846}}],"key":"V6GYoXnblvuuGHJNMy7MHyaunsU="}},{"name":"../Utilities/infoLog","data":{"asyncType":null,"locs":[{"start":{"line":103,"column":19,"index":3411},"end":{"line":103,"column":73,"index":3465}},{"start":{"line":106,"column":19,"index":3579},"end":{"line":106,"column":62,"index":3622}},{"start":{"line":114,"column":19,"index":3875},"end":{"line":114,"column":59,"index":3915}},{"start":{"line":142,"column":8,"index":4506},"end":{"line":145,"column":10,"index":4626}},{"start":{"line":160,"column":13,"index":5191},"end":{"line":160,"column":63,"index":5241}},{"start":{"line":161,"column":13,"index":5256},"end":{"line":161,"column":61,"index":5304}},{"start":{"line":166,"column":10,"index":5375},"end":{"line":169,"column":12,"index":5519}}],"key":"te7FMDljSHoh4Ptoq0ebhkaWbSA="}},{"name":"invariant","data":{"asyncType":null,"locs":[{"start":{"line":109,"column":10,"index":3673},"end":{"line":113,"column":11,"index":3854}}],"key":"Fzi/BpZws2YooIGJ9b6u0HJtuks="}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  var DEBUG = false;\n  var TaskQueue = function () {\n    function TaskQueue(_ref) {\n      var onMoreTasks = _ref.onMoreTasks;\n      _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/classCallCheck\")(this, TaskQueue);\n      this._onMoreTasks = onMoreTasks;\n      this._queueStack = [{\n        tasks: [],\n        popable: false\n      }];\n    }\n    _$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/helpers/createClass\")(TaskQueue, [{\n      key: \"enqueue\",\n      value: function enqueue(task) {\n        this._getCurrentQueue().push(task);\n      }\n    }, {\n      key: \"enqueueTasks\",\n      value: function enqueueTasks(tasks) {\n        var _this = this;\n        tasks.forEach(function (task) {\n          return _this.enqueue(task);\n        });\n      }\n    }, {\n      key: \"cancelTasks\",\n      value: function cancelTasks(tasksToCancel) {\n        this._queueStack = this._queueStack.map(function (queue) {\n          return Object.assign({}, queue, {\n            tasks: queue.tasks.filter(function (task) {\n              return tasksToCancel.indexOf(task) === -1;\n            })\n          });\n        }).filter(function (queue, idx) {\n          return queue.tasks.length > 0 || idx === 0;\n        });\n      }\n    }, {\n      key: \"hasTasksToProcess\",\n      value: function hasTasksToProcess() {\n        return this._getCurrentQueue().length > 0;\n      }\n    }, {\n      key: \"processNext\",\n      value: function processNext() {\n        var queue = this._getCurrentQueue();\n        if (queue.length) {\n          var task = queue.shift();\n          try {\n            if (typeof task === 'object' && task.gen) {\n              DEBUG && _$$_REQUIRE(_dependencyMap[2], \"../Utilities/infoLog\")('TaskQueue: genPromise for task ' + task.name);\n              this._genPromise(task);\n            } else if (typeof task === 'object' && task.run) {\n              DEBUG && _$$_REQUIRE(_dependencyMap[2], \"../Utilities/infoLog\")('TaskQueue: run task ' + task.name);\n              task.run();\n            } else {\n              _$$_REQUIRE(_dependencyMap[3], \"invariant\")(typeof task === 'function', 'Expected Function, SimpleTask, or PromiseTask, but got:\\n' + JSON.stringify(task, null, 2));\n              DEBUG && _$$_REQUIRE(_dependencyMap[2], \"../Utilities/infoLog\")('TaskQueue: run anonymous task');\n              task();\n            }\n          } catch (e) {\n            e.message = 'TaskQueue: Error with task ' + (task.name || '') + ': ' + e.message;\n            throw e;\n          }\n        }\n      }\n    }, {\n      key: \"_getCurrentQueue\",\n      value: function _getCurrentQueue() {\n        var stackIdx = this._queueStack.length - 1;\n        var queue = this._queueStack[stackIdx];\n        if (queue.popable && queue.tasks.length === 0 && this._queueStack.length > 1) {\n          this._queueStack.pop();\n          DEBUG && _$$_REQUIRE(_dependencyMap[2], \"../Utilities/infoLog\")('TaskQueue: popped queue: ', {\n            stackIdx: stackIdx,\n            queueStackSize: this._queueStack.length\n          });\n          return this._getCurrentQueue();\n        } else {\n          return queue.tasks;\n        }\n      }\n    }, {\n      key: \"_genPromise\",\n      value: function _genPromise(task) {\n        var _this2 = this;\n        this._queueStack.push({\n          tasks: [],\n          popable: false\n        });\n        var stackIdx = this._queueStack.length - 1;\n        var stackItem = this._queueStack[stackIdx];\n        DEBUG && _$$_REQUIRE(_dependencyMap[2], \"../Utilities/infoLog\")('TaskQueue: push new queue: ', {\n          stackIdx: stackIdx\n        });\n        DEBUG && _$$_REQUIRE(_dependencyMap[2], \"../Utilities/infoLog\")('TaskQueue: exec gen task ' + task.name);\n        task.gen().then(function () {\n          DEBUG && _$$_REQUIRE(_dependencyMap[2], \"../Utilities/infoLog\")('TaskQueue: onThen for gen task ' + task.name, {\n            stackIdx: stackIdx,\n            queueStackSize: _this2._queueStack.length\n          });\n          stackItem.popable = true;\n          _this2.hasTasksToProcess() && _this2._onMoreTasks();\n        }).catch(function (ex) {\n          setTimeout(function () {\n            ex.message = `TaskQueue: Error resolving Promise in task ${task.name}: ${ex.message}`;\n            throw ex;\n          }, 0);\n        });\n      }\n    }]);\n    return TaskQueue;\n  }();\n  module.exports = TaskQueue;\n});","lineCount":118,"map":[[2,2,11,0],[2,14,11,12],[4,2,26,0],[4,6,26,6,"DEBUG"],[4,11,26,18],[4,14,26,21],[4,19,26,26],[5,2,26,27],[5,6,44,6,"TaskQueue"],[5,15,44,15],[6,4,52,2],[6,29,52,61],[7,6,52,61],[7,10,52,15,"onMoreTasks"],[7,21,52,26],[7,29,52,15,"onMoreTasks"],[7,40,52,26],[8,6,52,26],[9,6,53,4],[9,10,53,8],[9,11,53,9,"_onMoreTasks"],[9,23,53,21],[9,26,53,24,"onMoreTasks"],[9,37,53,35],[10,6,54,4],[10,10,54,8],[10,11,54,9,"_queueStack"],[10,22,54,20],[10,25,54,23],[10,26,54,24],[11,8,54,25,"tasks"],[11,13,54,30],[11,15,54,32],[11,17,54,34],[12,8,54,36,"popable"],[12,15,54,43],[12,17,54,45],[13,6,54,50],[13,7,54,51],[13,8,54,52],[14,4,55,2],[15,4,55,3],[16,6,55,3],[17,6,55,3],[17,13,62,2],[17,30,62,10,"task"],[17,34,62,20],[17,36,62,28],[18,8,63,4],[18,12,63,8],[18,13,63,9,"_getCurrentQueue"],[18,29,63,25],[18,31,63,27],[18,32,63,28,"push"],[18,36,63,32],[18,37,63,33,"task"],[18,41,63,37],[18,42,63,38],[19,6,64,2],[20,4,64,3],[21,6,64,3],[22,6,64,3],[22,13,66,2],[22,35,66,15,"tasks"],[22,40,66,33],[22,42,66,41],[23,8,66,41],[24,8,67,4,"tasks"],[24,13,67,9],[24,14,67,10,"forEach"],[24,21,67,17],[24,22,67,18],[24,32,67,18,"task"],[24,36,67,22],[25,10,67,22],[25,17,67,26],[25,22,67,30],[25,23,67,31,"enqueue"],[25,30,67,38],[25,31,67,39,"task"],[25,35,67,43],[25,36,67,44],[26,8,67,44],[26,10,67,45],[27,6,68,2],[28,4,68,3],[29,6,68,3],[30,6,68,3],[30,13,70,2],[30,34,70,14,"tasksToCancel"],[30,47,70,40],[30,49,70,48],[31,8,72,4],[31,12,72,8],[31,13,72,9,"_queueStack"],[31,24,72,20],[31,27,72,23],[31,31,72,27],[31,32,72,28,"_queueStack"],[31,43,72,39],[31,44,73,7,"map"],[31,47,73,10],[31,48,73,11],[31,58,73,11,"queue"],[31,63,73,16],[32,10,73,16],[32,35,74,11,"queue"],[32,40,74,16],[33,12,75,8,"tasks"],[33,17,75,13],[33,19,75,15,"queue"],[33,24,75,20],[33,25,75,21,"tasks"],[33,30,75,26],[33,31,75,27,"filter"],[33,37,75,33],[33,38,75,34],[33,48,75,34,"task"],[33,52,75,38],[34,14,75,38],[34,21,75,42,"tasksToCancel"],[34,34,75,55],[34,35,75,56,"indexOf"],[34,42,75,63],[34,43,75,64,"task"],[34,47,75,68],[34,48,75,69],[34,53,75,74],[34,54,75,75],[34,55,75,76],[35,12,75,76],[36,10,75,77],[37,8,75,77],[37,9,76,8],[37,10,76,9],[37,11,77,7,"filter"],[37,17,77,13],[37,18,77,14],[37,28,77,15,"queue"],[37,33,77,20],[37,35,77,22,"idx"],[37,38,77,25],[38,10,77,25],[38,17,77,30,"queue"],[38,22,77,35],[38,23,77,36,"tasks"],[38,28,77,41],[38,29,77,42,"length"],[38,35,77,48],[38,38,77,51],[38,39,77,52],[38,43,77,56,"idx"],[38,46,77,59],[38,51,77,64],[38,52,77,65],[39,8,77,65],[39,10,77,66],[40,6,78,2],[41,4,78,3],[42,6,78,3],[43,6,78,3],[43,13,90,2],[43,42,90,31],[44,8,91,4],[44,15,91,11],[44,19,91,15],[44,20,91,16,"_getCurrentQueue"],[44,36,91,32],[44,38,91,34],[44,39,91,35,"length"],[44,45,91,41],[44,48,91,44],[44,49,91,45],[45,6,92,2],[46,4,92,3],[47,6,92,3],[48,6,92,3],[48,13,97,2],[48,36,97,22],[49,8,98,4],[49,12,98,10,"queue"],[49,17,98,15],[49,20,98,18],[49,24,98,22],[49,25,98,23,"_getCurrentQueue"],[49,41,98,39],[49,43,98,41],[50,8,99,4],[50,12,99,8,"queue"],[50,17,99,13],[50,18,99,14,"length"],[50,24,99,20],[50,26,99,22],[51,10,100,6],[51,14,100,12,"task"],[51,18,100,16],[51,21,100,19,"queue"],[51,26,100,24],[51,27,100,25,"shift"],[51,32,100,30],[51,34,100,32],[52,10,101,6],[52,14,101,10],[53,12,102,8],[53,16,102,12],[53,23,102,19,"task"],[53,27,102,23],[53,32,102,28],[53,40,102,36],[53,44,102,40,"task"],[53,48,102,44],[53,49,102,45,"gen"],[53,52,102,48],[53,54,102,50],[54,14,103,10,"DEBUG"],[54,19,103,15],[54,23,103,19],[54,78,103,27],[54,111,103,60],[54,114,103,63,"task"],[54,118,103,67],[54,119,103,68,"name"],[54,123,103,72],[54,124,103,73],[55,14,104,10],[55,18,104,14],[55,19,104,15,"_genPromise"],[55,30,104,26],[55,31,104,27,"task"],[55,35,104,31],[55,36,104,32],[56,12,105,8],[56,13,105,9],[56,19,105,15],[56,23,105,19],[56,30,105,26,"task"],[56,34,105,30],[56,39,105,35],[56,47,105,43],[56,51,105,47,"task"],[56,55,105,51],[56,56,105,52,"run"],[56,59,105,55],[56,61,105,57],[57,14,106,10,"DEBUG"],[57,19,106,15],[57,23,106,19],[57,78,106,27],[57,100,106,49],[57,103,106,52,"task"],[57,107,106,56],[57,108,106,57,"name"],[57,112,106,61],[57,113,106,62],[58,14,107,10,"task"],[58,18,107,14],[58,19,107,15,"run"],[58,22,107,18],[58,24,107,20],[59,12,108,8],[59,13,108,9],[59,19,108,15],[60,14,109,10],[60,58,110,12],[60,65,110,19,"task"],[60,69,110,23],[60,74,110,28],[60,84,110,38],[60,86,111,12],[60,145,111,71],[60,148,112,14,"JSON"],[60,152,112,18],[60,153,112,19,"stringify"],[60,162,112,28],[60,163,112,29,"task"],[60,167,112,33],[60,169,112,35],[60,173,112,39],[60,175,112,41],[60,176,112,42],[60,177,112,43],[60,178,113,11],[61,14,114,10,"DEBUG"],[61,19,114,15],[61,23,114,19],[61,78,114,27],[61,109,114,58],[61,110,114,59],[62,14,115,10,"task"],[62,18,115,14],[62,20,115,16],[63,12,116,8],[64,10,117,6],[64,11,117,7],[64,12,117,8],[64,19,117,15,"e"],[64,20,117,16],[64,22,117,18],[65,12,118,8,"e"],[65,13,118,9],[65,14,118,10,"message"],[65,21,118,17],[65,24,119,10],[65,53,119,39],[65,57,119,43,"task"],[65,61,119,47],[65,62,119,48,"name"],[65,66,119,52],[65,70,119,56],[65,72,119,58],[65,73,119,59],[65,76,119,62],[65,80,119,66],[65,83,119,69,"e"],[65,84,119,70],[65,85,119,71,"message"],[65,92,119,78],[66,12,120,8],[66,18,120,14,"e"],[66,19,120,15],[67,10,121,6],[68,8,122,4],[69,6,123,2],[70,4,123,3],[71,6,123,3],[72,6,123,3],[72,13,132,2],[72,41,132,34],[73,8,133,4],[73,12,133,10,"stackIdx"],[73,20,133,18],[73,23,133,21],[73,27,133,25],[73,28,133,26,"_queueStack"],[73,39,133,37],[73,40,133,38,"length"],[73,46,133,44],[73,49,133,47],[73,50,133,48],[74,8,134,4],[74,12,134,10,"queue"],[74,17,134,15],[74,20,134,18],[74,24,134,22],[74,25,134,23,"_queueStack"],[74,36,134,34],[74,37,134,35,"stackIdx"],[74,45,134,43],[74,46,134,44],[75,8,135,4],[75,12,136,6,"queue"],[75,17,136,11],[75,18,136,12,"popable"],[75,25,136,19],[75,29,137,6,"queue"],[75,34,137,11],[75,35,137,12,"tasks"],[75,40,137,17],[75,41,137,18,"length"],[75,47,137,24],[75,52,137,29],[75,53,137,30],[75,57,138,6],[75,61,138,10],[75,62,138,11,"_queueStack"],[75,73,138,22],[75,74,138,23,"length"],[75,80,138,29],[75,83,138,32],[75,84,138,33],[75,86,139,6],[76,10,140,6],[76,14,140,10],[76,15,140,11,"_queueStack"],[76,26,140,22],[76,27,140,23,"pop"],[76,30,140,26],[76,32,140,28],[77,10,141,6,"DEBUG"],[77,15,141,11],[77,19,142,8],[77,74,142,16],[77,101,142,43],[77,103,142,45],[78,12,143,10,"stackIdx"],[78,20,143,18],[78,22,143,10,"stackIdx"],[78,30,143,18],[79,12,144,10,"queueStackSize"],[79,26,144,24],[79,28,144,26],[79,32,144,30],[79,33,144,31,"_queueStack"],[79,44,144,42],[79,45,144,43,"length"],[80,10,145,8],[80,11,145,9],[80,12,145,10],[81,10,146,6],[81,17,146,13],[81,21,146,17],[81,22,146,18,"_getCurrentQueue"],[81,38,146,34],[81,40,146,36],[82,8,147,4],[82,9,147,5],[82,15,147,11],[83,10,148,6],[83,17,148,13,"queue"],[83,22,148,18],[83,23,148,19,"tasks"],[83,28,148,24],[84,8,149,4],[85,6,150,2],[86,4,150,3],[87,6,150,3],[88,6,150,3],[88,13,152,2],[88,34,152,14,"task"],[88,38,152,31],[88,40,152,33],[89,8,152,33],[90,8,157,4],[90,12,157,8],[90,13,157,9,"_queueStack"],[90,24,157,20],[90,25,157,21,"push"],[90,29,157,25],[90,30,157,26],[91,10,157,27,"tasks"],[91,15,157,32],[91,17,157,34],[91,19,157,36],[92,10,157,38,"popable"],[92,17,157,45],[92,19,157,47],[93,8,157,52],[93,9,157,53],[93,10,157,54],[94,8,158,4],[94,12,158,10,"stackIdx"],[94,20,158,18],[94,23,158,21],[94,27,158,25],[94,28,158,26,"_queueStack"],[94,39,158,37],[94,40,158,38,"length"],[94,46,158,44],[94,49,158,47],[94,50,158,48],[95,8,159,4],[95,12,159,10,"stackItem"],[95,21,159,19],[95,24,159,22],[95,28,159,26],[95,29,159,27,"_queueStack"],[95,40,159,38],[95,41,159,39,"stackIdx"],[95,49,159,47],[95,50,159,48],[96,8,160,4,"DEBUG"],[96,13,160,9],[96,17,160,13],[96,72,160,21],[96,101,160,50],[96,103,160,52],[97,10,160,53,"stackIdx"],[97,18,160,61],[97,20,160,53,"stackIdx"],[98,8,160,61],[98,9,160,62],[98,10,160,63],[99,8,161,4,"DEBUG"],[99,13,161,9],[99,17,161,13],[99,72,161,21],[99,99,161,48],[99,102,161,51,"task"],[99,106,161,55],[99,107,161,56,"name"],[99,111,161,60],[99,112,161,61],[100,8,162,4,"task"],[100,12,162,8],[100,13,163,7,"gen"],[100,16,163,10],[100,18,163,12],[100,19,164,7,"then"],[100,23,164,11],[100,24,164,12],[100,36,164,18],[101,10,165,8,"DEBUG"],[101,15,165,13],[101,19,166,10],[101,74,166,18],[101,107,166,51],[101,110,166,54,"task"],[101,114,166,58],[101,115,166,59,"name"],[101,119,166,63],[101,121,166,65],[102,12,167,12,"stackIdx"],[102,20,167,20],[102,22,167,12,"stackIdx"],[102,30,167,20],[103,12,168,12,"queueStackSize"],[103,26,168,26],[103,28,168,28],[103,34,168,32],[103,35,168,33,"_queueStack"],[103,46,168,44],[103,47,168,45,"length"],[104,10,169,10],[104,11,169,11],[104,12,169,12],[105,10,170,8,"stackItem"],[105,19,170,17],[105,20,170,18,"popable"],[105,27,170,25],[105,30,170,28],[105,34,170,32],[106,10,171,8],[106,16,171,12],[106,17,171,13,"hasTasksToProcess"],[106,34,171,30],[106,36,171,32],[106,40,171,36],[106,46,171,40],[106,47,171,41,"_onMoreTasks"],[106,59,171,53],[106,61,171,55],[107,8,172,6],[107,9,172,7],[107,10,172,8],[107,11,173,7,"catch"],[107,16,173,12],[107,17,173,13],[107,27,173,13,"ex"],[107,29,173,15],[107,31,173,19],[108,10,174,8,"setTimeout"],[108,20,174,18],[108,21,174,19],[108,33,174,25],[109,12,175,10,"ex"],[109,14,175,12],[109,15,175,13,"message"],[109,22,175,20],[109,25,175,24],[109,71,175,69,"task"],[109,75,175,73],[109,76,175,74,"name"],[109,80,175,79],[109,85,175,83,"ex"],[109,87,175,85],[109,88,175,86,"message"],[109,95,175,94],[109,97,175,95],[110,12,176,10],[110,18,176,16,"ex"],[110,20,176,18],[111,10,177,8],[111,11,177,9],[111,13,177,11],[111,14,177,12],[111,15,177,13],[112,8,178,6],[112,9,178,7],[112,10,178,8],[113,6,179,2],[114,4,179,3],[115,4,179,3],[116,2,179,3],[117,2,182,0,"module"],[117,8,182,6],[117,9,182,7,"exports"],[117,16,182,14],[117,19,182,17,"TaskQueue"],[117,28,182,26],[118,0,182,27]],"functionMap":{"names":["<global>","TaskQueue","constructor","enqueue","enqueueTasks","tasks.forEach$argument_0","cancelTasks","_queueStack.map$argument_0","queue.tasks.filter$argument_0","_queueStack.map.filter$argument_0","hasTasksToProcess","processNext","_getCurrentQueue","_genPromise","task.gen.then$argument_0","task.gen.then._catch$argument_0","setTimeout$argument_0"],"mappings":"AAA;AC2C;ECQ;GDG;EEO;GFE;EGE;kBCC,0BD;GHC;EKE;WCG;kCCE,0CD;QDC;cGC,mDH;GLC;ESY;GTE;EUK;GV0B;EWS;GXkB;EYE;YCY;ODQ;aEC;mBCC;SDG;OFC;GZC;CDC"}},"type":"js/module"}]}